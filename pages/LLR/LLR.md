<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
[TOC]

# 比特判决的总体流程

图 1 是一个简化的信道示意图。通信信道，例如在900MHz的频率上发送数据，会使用900MHz的 cosine 波和 sine 波同时传输两个信号，因为同一个频率下的 cosine 波与 sine 波是正交的，所以，是可以分离出来，进而接收方可以得到两路信号 $ y_{I}$,和$y_{Q} $. 如果信道没有任何噪声污染的话，那收到的信号就等于发送的信号. 但是，因为信道有噪声，则导致接收的信号不等于发送的信号. 因此，我们需要根据接收到的信号，判断发送者发送的数据到底是 0 还是 1.
![图 1 传输信道](https://upload-images.jianshu.io/upload_images/17587366-f32c8b0dee3162d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



因为被噪声污染的程度是随机的，因此，自然而然就想到可以用概率来判断，如果通过分析，在接收到一对确定的 $ y_{I} $,和 $ y_{Q} $后，可以计算出发送者发送 0 的概率是多少，发送 1 的概率是多少，那么若发送 0 的概率大于发送 1 的概率，则可以判断发送的是 0，若发送 1 的概率大于发送 0 的概率，则可以判断发送的是 1.

因此，我们引入一个概率的比值. 我们用 p 表示概率，$p=\left ( b=0|y_{I},y_{Q}  \right ) $表示收到 $y_{I}$,和$y_{Q}$后，发送者发送的是 0 的概率，$p=\left ( b=1|y_{I},y_{Q}  \right ) $ 表示收到  $y_{I}$,和$y_{Q}$ 后，发送者发送的是 1 的概率. 这里特别强调一下，这里的 $y_{I}$,和$y_{Q}$，在接收者这里是接收到的信号，所以，是两个确定的数值，例如 $y_{I}=0.5$,和$y_{Q}=4.8$ 等等这样具体的数值了.


$$
LR\left ( b \right )=\frac{p(b=0|y_{I},y_{Q})}{p(b=1|y_{I},y_{Q})}=\frac{p(b=0,y_{I},y_{Q})/p(y_{I},y_{Q})}{p(b=1,y_{I},y_{Q})/p(y_{I},y_{Q})}=\frac{p(b=0,y_{I},y_{Q})}{p(b=1,y_{I},y_{Q})}  \tag{1.1}
$$

继续推导$(1.1)$：
$$ LR\left ( b \right )=\frac{p(y_{I},y_{Q}/b=0)p(b=0)}{p(y_{I},y_{Q}/b=1)p(b=1)}  \tag{1.2} $$
这里有一个重要的假设：发送方发送 0 或者 1，是随机的，但是是等概率的，所以，经常在通信系统中对数据进行加扰后再传输，就是要保证在一段时间内，平均来看，发送0的数量和发送1的数量大致是相等，即保证等概率.

因为 
$p(b=0)=p(b=1)= \frac{1}{2}$，代入$(1.2)$：
$$
LR\left ( b \right )=\frac{p(y_{I},y_{Q}/b=0)}{p(y_{I},y_{Q}/b=1)}  \tag{1.3}
$$

接下来如何继续计算 $(1.3)$的概率，我们结合具体的调制方式来讲解.

# 对于 BPSK 调制的 LLR 推导
通信过程：有一个比特数据 b ，用 BPSK 调制后，经过一个信道传输，发送给接收者，接收者收到$y_{I}$,和$y_{Q}$ 两个数据.

![图 2 BPSK调制后的传输信道](https://upload-images.jianshu.io/upload_images/17587366-64a99e12f5c630aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


**BPSK调制**
|b|I    + j Q|
|:-----: |:------: |
|0|1+0j|
|1|-1+0j|

图二中上下两路，可以认为是相互独立的，加的 都是 0 均值的 “加性高斯白噪声”.
现在先给出均值为$u$的高斯白噪声的概率分布公式：
$$p(x)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(x-u)^2}{2\delta^2}} \tag{2.1.1}$$
因为通信信道中的白噪声，我们假定是 0 均值的，因此，在传输了一个特定信号，例如 b，则其均值就变成了 b.

例如，发送的数据 $\frac{\sqrt2}{2}$，加上 0 均值的高斯白噪声，则接收到的均值，就从 0 变成了 $\frac{\sqrt2}{2}$，因此，收到数据如果是 $y$，那么其概率分布也是高斯分布，只是均值有变化，对应如下公式：
$$p(y)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y-\frac{\sqrt2}{2})^2}{2\delta^2}} \tag{2.1.2}$$

## 推导 BPSK 下似然比(LR)
I)  从公式$(1.3)$，当 $b=0$时，根据 BPSK 调制表格，可以知道 $I=1,Q=0$，可以认为$b=0$与$I=1,Q=0$这是同一事件，因此：
$$p(y_{I},y_{Q}/b=0)=p(y_{I},y_{Q}/I=1,Q=0)\tag{2.2.1}$$
因为可以把图二中上下两个白噪声信道，认为是相互独立的，因此，式$(2.2.1)$可以推导为：
$$p(y_{I},y_{Q}/b=0)=p(y_{I},y_{Q}/I=1,Q=0)=p(y_{I}/I=1)p(y_{Q}/Q=0)\tag{2.2.2}$$
II) 从公式$(1.3)$，当 $b=1$时，根据 BPSK 调制表格，可以知道 $I=-1,Q=0$，可以认为$b=1$与$I=-1,Q=0$这是同一事件，因此：
$$p(y_{I},y_{Q}/b=1)=p(y_{I},y_{Q}/I=-1,Q=0)\tag{2.2.3}$$
因为可以把图二中上下两个白噪声信道，认为是相互独立的，因此，式$(2.2.3)$可以推导为：
$$p(y_{I},y_{Q}/b=1)=p(y_{I},y_{Q}/I=-1,Q=0)=p(y_{I}/I=-1)p(y_{Q}/Q=0)\tag{2.2.4}$$
### 计算$p(y_{I},y_{Q}/b=0)$
$p(y_{I}/I=1)$，表示发送的是1，收到的是$y_{I}$，因为是加性白噪声信道，根据式$(2.1.1)$, 可以得出其概率分布：
$$(y_{I}/I=1)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}-1)^2}{2\delta^2 }} \tag{2.3.1}$$

同理，可以计算出$p(y_{Q}/Q=0)$的概率分布：
$$(y_{Q}/Q=0)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-0)^2}{2\delta^2}} \tag{2.3.2}$$
把式$(2.3.1)$和$(2.3.2)$代入$(2.2.2)$：
$$p(y_{I},y_{Q}/b=0)=p(y_{I},y_{Q}/I=1,Q=0)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}-1)^2}{2\delta^2 }}\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-0)^2}{2\delta^2}} \tag{2.3.3}$$
整理后得到：
$$p(y_{I},y_{Q}/b=0)=\frac{1}{\delta^{2}2\pi}e^{-\frac{(y_{I}-1)^{2}+(y_{Q}-0)^2}{2\delta^2}}\tag{2.3.4 }$$
### 计算$p(y_{I},y_{Q}/b=1)$
类似与计算$p(y_{I}/I=1)$的思路，$p(y_{I}/I=-1)$表示发送的是 0 , 收到的是 $y_{I}$的概率，根据式$(2.1.1)$，可以得出其概率分布为：
$$\left (  y_{I}/I=-1\right )=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{\left (y_{I}- \left (-1\right ) \right )^2}{2\delta^2} }=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{\left (y_{I}+1 \right )^2}{2\delta^2}} \tag{2.4.1}$$
同理，可以计算出$p(y_{Q}/Q=0)$的概率分布：
$$(y_{Q}/Q=0)=\frac{1}{\delta\sqrt{2\pi}}e^{-\frac{(y_{Q}-0)^2}{2\delta^2 }} \tag{2.4.2} $$
把式$(2.4.1)$和$(2.4.2)$代入$(2.2.4)$：
$$p(y_{I},y_{Q}/b=1)=p(y_{I},y_{Q}/I=-1,Q=0)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}+1)^2}{2\delta^2}}\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-0)^2}{2\delta^2}} \tag{2.4.3}$$
整理后得到：
$$p(y_{I},y_{Q}/b=1)=\frac{1}{\delta^{2}2\pi}e^{-\frac{(y_{I}+1)^{2}+(y_{Q}-0)^2}{2\delta^2}}\tag{2.4.4 }$$
### 计算 LR(b)
把式$(2.3.4)$和$(2.4.4)$代入$(1.3)$：
$$LR( b ) =\frac{p(y_{I},y_{Q}/b=0)}{p(y_{I},y_{Q}/b=1)}=\frac{\frac{1}{\delta^{2}2\pi}e^{-\frac{(y_{I}-1)^{2}+(y_{Q}-0)^2}{2\delta^2}}}     {\frac{1}{\delta^{2}2\pi}e^{-\frac{(y_{I}+1)^{2}+(y_{Q}-0)^2}{2\delta^2}}}=\frac{e^{-\frac{(y_{I}-1)^{2}+(y_{Q})^2}{2\delta^2}}}     {e^{-\frac{(y_{I}+1)^{2}+(y_{Q})^2}{2\delta^2 }}} \tag{2.5.1 }$$
进一步整理有：
$$LR\left( b \right) ={e^{-\frac{\left(y_{I}-1\right)^{2}+y_{Q}^2}{2\delta^2}+\frac{\left(y_{I}+1\right)^{2}+y_{Q}^2}{2\delta^2}}}= {e^{\frac{y_{I}}   {\delta^2}}} \tag{2.5.2 }$$
## 计算 LLR(b)
对式(2.5.2)再取自然对数，生成对数似然比:
$$LLR(b)=\frac{y_{I}}   {\delta^2} \tag {2.6.1}$$

## 判决
如果 LLR(b) > 0，则 b = 0；
如果 LLR(b) < 0，则 b = 1.

# 对于 QPSK 调制的 LLR 推导

因为是 QPSK 调制，所以，每两个比特生成一个 I/Q对，经过信道发送出去，接收方收到一对 $y_{I}$,和 $y_{Q}$ . 因为 $y_{I}$,和 $y_{Q}$ 是分别通过cosine和sine波传输过来的，可以认为是相互独立的.

**QPSK调制**

|  $b_{1}b_{0}$  | I    + j Q |
| :--: | :--------: |
|  00  |    $\frac{\sqrt2}{2}+j\frac{\sqrt2}{2}$    |
|  01  | $-\frac{\sqrt2}{2}+j\frac{\sqrt2}{2}$ |
| 11 | $-\frac{\sqrt2}{2}-j\frac{\sqrt2}{2}$ |
| 10 | $\frac{\sqrt2}{2}-j\frac{\sqrt2}{2}$ |

高斯白噪声的概率分布公式，请参考前面公式 $(2.1.1)$和$(2.1.2)$.

对于输入的两个比特，$b_{0}$和 $b_{1}$是分开分别分析并判决的.

## 推导 QPSK 下$b_{0}$对数似然比 $LLR(b_{0})$

I)  从公式$(1.3)$，当 $b_{0}=0$时，根据 QPSK 调制表格，$I$和$Q$有两种情况：

​						 $I=\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2}$

​						 $I=\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2}$

可以认为$b_{0}=0$是与上面两种情况都发生是同一事件，因此，是两种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I},y_{Q}/I=\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2})+p(y_{I},y_{Q}/I=\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2})\tag{3.1.1}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(3.1.1)$可以推导为：
$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I}/I=\frac{\sqrt2}{2})p(y_{Q}/Q=\frac{\sqrt2}{2})+p(y_{I}/I=\frac{\sqrt2}{2})p(y_{Q}/Q=-\frac{\sqrt2}{2})\tag{3.1.2}$$

II) 从公式$(1.3)$，当 $b_{0}=1$时，根据 QPSK 调制表格，$I$和$Q$有两种情况：

​						 $I=-\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2}$

​						 $I=-\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2}$

可以认为$b_{0}=0$是与上面两种情况都发生是同一事件，因此，是两种情况下的概率的和，因此：

$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I},y_{Q}/I=-\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2})+p(y_{I},y_{Q}/I=-\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2})\tag{3.1.3}$$



因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(3.1.1)$可以推导为：

$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I}/I=-\frac{\sqrt2}{2})p(y_{Q}/Q=\frac{\sqrt2}{2})+p(y_{I}/I=-\frac{\sqrt2}{2})p(y_{Q}/Q=-\frac{\sqrt2}{2})\tag{3.1.4}$$

### 计算$p(y_{I},y_{Q}/b_{0}=0)$

$p(y_{I}/I=\frac{\sqrt2}{2})$，表示发送的是$\frac{\sqrt2}{2}$，收到的是$y_{I}$，因为是加性白噪声信道，根据式$(2.1.1)$, 可以得出其概率分布：
$$(y_{I}/I=1)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2}{2\delta^2 }} \tag{3.2.1}$$

类似的，可以计算出$p(y_{I}/I=-\frac{\sqrt2}{2})$

$$(y_{I}/I=1)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2}{2\delta^2 }} \tag{3.2.2}$$

同理，可以计算出$p(y_{Q}/Q=\frac{\sqrt2}{2})$的概率分布：
$$(y_{Q}/Q=0)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2}} \tag{3.2.3}$$

类似的，可以计算出$p(y_{Q}/Q=-\frac{\sqrt2}{2})$的概率分布：
$$(y_{Q}/Q=0)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2}} \tag{3.2.4}$$

把式$(3.2.1)$，$(3.2.2)$，$(3.2.3)$和$(3.2.4)$代入$(3.1.2)$并整理：
$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2+(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2+(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\tag{3.2.5} $$

把指数中的加法展开成乘法，并把相同项提取出来，整理成下式：

$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2}{2\delta^2 }}  \left(e^{-\frac{(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2}}  + e^{-\frac{(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\right )\tag{3.2.6} $$

### 计算$p(y_{I},y_{Q}/b_{0}=1)$

类似与计算$p(y_{I},y_{Q}/b_{0}=0)$的思路，把式$(3.2.1)$，$(3.2.2)$，$(3.2.3)$和$(3.2.4)$代入$(3.1.4)$并整理：
$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2+(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2+(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\tag{3.3.1} $$

把指数中的加法展开成乘法，并把相同项提取出来，整理成下式：

$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2}{2\delta^2 }}  \left(e^{-\frac{(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2}}  + e^{-\frac{(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\right )\tag{3.3.2} $$

### 计算 $LR(b_{0})$

把式$(3.2.5)$和$(3.3.2)$代入$(1.3)$，注意式$(3.2.5)$和$(3.3.2)$等号右边的括号内的项是相等的，因此可以直接约掉：
$$LR( b_{0} ) =  \frac{p(y_{I},y_{Q}/b_{0}=0)}{p(y_{I},y_{Q}/b_{0}=1)}  =   \frac{  e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^{2}}{2\delta^2}}}     {e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^{2}}{2\delta^2 }}  } \tag{3.4.1 }$$
进一步整理有：

$$LR\left( b_{0} \right) = e^{-\frac{\left(y_{I}-1\right)^{2}+\left(y_{I}+1\right)^{2}}          {2\delta^2}}= {e^{\frac{2y_{I}}   {\delta^2}}} \tag{3.4.2 }$$

### 计算 $LLR(b_{0})$

对式$(3.4.2)$再取自然对数，生成对数似然比:

$$LLR(b_{0})=\frac{2y_{I}}   {\delta^2} \tag {3.5.1}$$

### 判决

如果 $LLR(b_{0}) > 0$，则 $b_{0} = 0$；
如果 $LLR(b_{0}) < 0$，则 $b_{0} = 1$.

## 推导 QPSK 下$b_{1}$对数似然比 $LLR(b_{1})$

I)  从公式$(1.3)$，当 $b_{1}=0$时，根据 QPSK 调制表格，$I$和$Q$有两种情况：

​						 $I=\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2}$

​						 $I=-\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2}$

可以认为$b_{1}=0$是与上面两种情况都发生是同一事件，因此，是两种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{1}=0)=p(y_{I},y_{Q}/I=\frac{\sqrt2}{2},Q=\frac{\sqrt2}{2})+p(y_{I},y_{Q}/I=\frac{-\sqrt2}{2},Q=\frac{\sqrt2}{2})\tag{4.1.1}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(4.1.1)$可以推导为：
$$p(y_{I},y_{Q}/b_{1}=0) =  p(y_{I}/I=\frac{\sqrt2}{2})p(y_{Q}/Q=\frac{\sqrt2}{2})+p(y_{I}/I=-\frac{\sqrt2}{2})p(y_{Q}/Q=\frac{\sqrt2}{2})\tag{4.1.2}$$

II) 从公式$(1.3)$，当 $b_{1}=1$时，根据 QPSK 调制表格，$I$和$Q$有两种情况：

​						 $I=\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2}$

​						 $I=-\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2}$

可以认为$b_{0}=0$是与上面两种情况都发生是同一事件，因此，是两种情况下的概率的和，因此：

$$p(y_{I},y_{Q}/b_{1}=1)=p(y_{I},y_{Q}/I=\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2})+p(y_{I},y_{Q}/I=-\frac{\sqrt2}{2},Q=-\frac{\sqrt2}{2})\tag{4.1.3}$$



因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(3.1.1)$可以推导为：

$$p(y_{I},y_{Q}/b_{1}=1)=p(y_{I}/I=\frac{\sqrt2}{2})p(y_{Q}/Q=-\frac{\sqrt2}{2})+p(y_{I}/I=-\frac{\sqrt2}{2})p(y_{Q}/Q=-\frac{\sqrt2}{2})\tag{4.1.4}$$



### 计算$p(y_{I},y_{Q}/b_{1}=0)$

把式$(3.2.1)$，$(3.2.2)$，$(3.2.3)$和$(3.2.4)$代入$(4.1.2)$并整理：
$$ p(y_{I},y_{Q}/b_{1}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2+(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2 }}  +  \frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2+(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2 }}\tag{4.2.1} $$

把指数中的加法展开成乘法，并把相同项提取出来，整理成下式：

$$ p(y_{I},y_{Q}/b_{1}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{Q}-\frac{\sqrt2}{2})^2}{2\delta^2 }}  \left(e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2}{2\delta^2}}  + e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\right )\tag{4.2.2} $$

### 计算$p(y_{I},y_{Q}/b_{1}=1)$

类似与计算$p(y_{I},y_{Q}/b_{1}=0)$的思路，把式$(3.2.1)$，$(3.2.2)$，$(3.2.3)$和$(3.2.4)$代入$(4.1.4)$并整理：
$$ p(y_{I},y_{Q}/b_{1}=1)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2+(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2+(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\tag{4.3.1} $$

把指数中的加法展开成乘法，并把相同项提取出来，整理成下式：

$$ p(y_{I},y_{Q}/b_{1}=1)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{Q}+\frac{\sqrt2}{2})^2}{2\delta^2 }}  \left(e^{-\frac{(y_{I}-\frac{\sqrt2}{2})^2}{2\delta^2}}  + e^{-\frac{(y_{I}+\frac{\sqrt2}{2})^2}{2\delta^2 }}\right )\tag{4.3.2} $$

### 

### 计算 $LR(b_{1})$

把式$(4.2.2)$和$(4.3.2)$代入$(1.3)$，注意式$(4.2.2)$和$(4.3.2)$等号右边的括号内的项是相等的，因此可以直接约掉：
$$LR( b_{1} ) =  \frac{p(y_{I},y_{Q}/b_{1}=0)}{p(y_{I},y_{Q}/b_{1}=1)}  =   \frac{  e^{-\frac{(y_{Q}-\frac{\sqrt2}{2})^{2}}{2\delta^2}}}     {e^{-\frac{(y_{Q}+\frac{\sqrt2}{2})^{2}}{2\delta^2 }}  } \tag{4.4.1 }$$
进一步整理有：

$$LR\left( b_{1} \right) = e^{-\frac{\left(y_{Q}-1\right)^{2}+\left(y_{Q}+1\right)^{2}}          {2\delta^2}}= {e^{\frac{2y_{I}}   {\delta^2}}} \tag{4.4.2 }$$

### 计算 $LLR(b_{1})$

对式$(4.4.2)$再取自然对数，生成对数似然比:

$$LLR(b_{1})=\frac{2y_{Q}}   {\delta^2} \tag {4.5.1}$$

### 判决

如果 $LLR(b_{1}) > 0$，则 $b_{1} = 0$；
如果 $LLR(b_{1}) < 0$，则 $b_{1} = 1$.

# 对于 8-PSK 调制的 LLR 推导

因为是 8-PSK 调制，所以，每三个比特生成一个 I/Q对，经过信道发送出去，接收方收到一对 $y_{I}$,和 $y_{Q}$ . 因为 $y_{I}$,和 $y_{Q}$ 是分别通过cosine和sine波传输过来的，可以认为是相互独立的.

为了行文的简洁，现在定义两个常量  

$c=cos(\frac{pi}{8})=0.9239$

$s=sin(\frac{pi}{8})=0.3827$

**8-PSK调制**

| $b_{2}b_{1}b_{0}$ | I    + j Q |
| :---------------: | :--------: |
|        000        |   $c+js$   |
|        001        |   $s+jc$   |
|        011        |  $-s+jc$   |
|        010        |  $-c+js$   |
|        110        |  $-c-js$   |
|        111        |  $-s-jc$   |
|        101        |   $s-jc$   |
|        100        |   $c-js$   |

噪声的概率分布公式，请参考前面公式 $(2.1.1)$和$(2.1.2)$.

对于输入的三个比特，$b_{0}$， $b_{1}$和$b_{2}$是分别分析并判决的.

## 推导 8-PSK 下$b_{0}$对数似然比 $LLR(b_{0})$

I)  从公式$(1.3)$，当 $b_{0}=0$时，根据 8-PSK 调制表格，$I$和$Q$有四种情况：

​						 $I=c,Q=s$

​						 $I=-c,Q=s$

​						 $I=-c,Q=-s$

​						 $I=c,Q=-s$

可以认为$b_{0}=0$是与上面四种情况都发生是同一事件，因此，是四种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I},y_{Q}/I=c,Q=s)+p(y_{I},y_{Q}/I=-c,Q=s)\\ +p(y_{I},y_{Q}/I=-c,Q=-s)+p(y_{I},y_{Q}/I=c,Q=-s) \tag{5.1.1}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(5.1.1)$可以推导为：
$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I}/I=c)p(y_{Q}/Q=s)+p(y_{I}/I=-c)p(y_{Q}/Q=s)\\ +p(y_{I}/I=-c)p(y_{Q}/Q=-s)+p(y_{I}/I=c)p(y_{Q}/Q=-s) \tag{5.1.2}$$

II) 从公式$(1.3)$，当 $b_{0}=1$时，根据 8-PSK 调制表格，$I$和$Q$有四种情况：

​						 $I=s,Q=c$

​						 $I=-s,Q=c$

​						 $I=-s,Q=-c$

​						 $I=s,Q=-c$

可以认为$b_{0}=1$是与上面四种情况都发生是同一事件，因此，是四种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{0}=1)=p(y_{I},y_{Q}/I=s,Q=c)+p(y_{I},y_{Q}/I=-s,Q=c)\\ +p(y_{I},y_{Q}/I=-s,Q=-c)+p(y_{I},y_{Q}/I=s,Q=-c) \tag{5.1.3}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(5.1.3)$可以推导为：
$$p(y_{I},y_{Q}/b_{0}=1)=p(y_{I}/I=s)p(y_{Q}/Q=c)+p(y_{I}/I=-s)p(y_{Q}/Q=c)\\ +p(y_{I}/I=-s)p(y_{Q}/Q=-c)+p(y_{I}/I=s)p(y_{Q}/Q=-c) \tag{5.1.4}$$



### 计算$p(y_{I},y_{Q}/b_{0}=0)$

$p(y_{I}/I=s)$，表示发送的是$s$，收到的是$y_{I}$，因为是加性白噪声信道，根据式$(2.1.1)$, 可以得出其概率分布：
$$(y_{I}/I=s)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}-s)}{2\delta^2 }} \tag{5.2.1}$$

类似的，可以计算出$p(y_{I}/I=-s)$

$$(y_{I}/I=-s)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}+s)}{2\delta^2 }} \tag{5.2.2}$$

同理，可以计算出：

$$(y_{I}/I=c)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}-c)}{2\delta^2 }} \tag{5.2.3}$$

$$(y_{I}/I=-c)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{I}+c)}{2\delta^2 }} \tag{5.2.4}$$

$$(y_{Q}/Q=s)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-s)}{2\delta^2 }} \tag{5.2.5}$$

$$(y_{Q}/Q=-s)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}+s)}{2\delta^2 }} \tag{5.2.6}$$

$$(y_{Q}/Q=c)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}-c)}{2\delta^2 }} \tag{5.2.7}$$

$$(y_{Q}/Q=-c)=\frac{1}{\delta\sqrt{2\pi }}e^{-\frac{(y_{Q}+c)}{2\delta^2 }} \tag{5.2.8}$$

把式$(5.2.1)$至$(5.2.8)$代入$(5.1.2)$并整理：
$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-c})^2+(y_{Q}{\color{Red}-s})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+c})^2+(y_{Q}{\color{Red}-s})^2}{2\delta^2 }} + \\   \frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+c})^2+(y_{Q}{\color{Red}+s})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-c})^2+(y_{Q}{\color{Red}+s})^2}{2\delta^2 }}\tag{5.2.9} $$

### 计算$p(y_{I},y_{Q}/b_{0}=1)$

类似与计算$p(y_{I},y_{Q}/b_{0}=0)$的思路，把式$(5.2.1)$至$(5.2.8)$代入$(5.1.4)$并整理：
$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red} -s} )^2+(y_{Q}{\color{Red}-c})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+s})^2+(y_{Q}{\color{Red}-c})^2}{2\delta^2 }} + \\   \frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+s})^2+(y_{Q}{\color{Red}+c})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-s})^2+(y_{Q}{\color{Red}+c})^2}{2\delta^2 }}\tag{5.3.1} $$

### 

### 计算 $LR(b_{0})$

把式$(5.2.9)$和$(5.3.1)$代入$(1.3)$：
$$LR( b_{0} ) =  \frac{p(y_{I},y_{Q}/b_{0}=0)}{p(y_{I},y_{Q}/b_{0}=1)}  =   \frac{ e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}}}     {e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}} \tag{5.4.1 }$$

其中:

​             $$ a_{1} = -\frac{(y_{I}-c)^2+(y_{Q}-s)^2}{2\delta^2 } $$

​             $$ a_{2} = -\frac{(y_{I}+c)^2+(y_{Q}-s)^2}{2\delta^2 } $$

​             $$ a_{3} = -\frac{(y_{I}+c)^2+(y_{Q}+s)^2}{2\delta^2 } $$

​             $$ a_{4} = -\frac{(y_{I}-c)^2+(y_{Q}+s)^2}{2\delta^2 } $$

​             $$ b_{1} = -\frac{(y_{I}-s)^2+(y_{Q}-c)^2}{2\delta^2 } $$

​             $$ b_{2} = -\frac{(y_{I}+s)^2+(y_{Q}-c)^2}{2\delta^2 } $$

​             $$ b_{3} = -\frac{(y_{I}+s)^2+(y_{Q}+c)^2}{2\delta^2 } $$

​             $$ b_{4} = -\frac{(y_{I}-s)^2+(y_{Q}+c)^2}{2\delta^2 } $$



### 计算 $LLR(b_{0})$

对式$(5.4.1)$再取自然对数，生成对数似然比:

$$LLR( b_{0} ) =  ln \frac{p(y_{I},y_{Q}/b_{0}=0)}{p(y_{I},y_{Q}/b_{0}=1) }  =   ln\frac{ e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}}}     {e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}}\\=ln( e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}})-     ln(e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}) \tag{5.5.1 }$$

式$(5.5.1)$已经不是很容易计算的公式了. 如果为了降低运算量，则需要简化计算。下面是一个近似计算方法.

因为$e^{b_{1}}$, $e^{b_{2}}$,$e^{b_{3}}$和$e^{b_{4}}$都是正数，因此取这四个数中最大的保留，其余的都舍弃:

​       $$ A = max(e^{a_{1}},e^{a_{2}},e^{a_{3}},e^{a_{4}})$$

​      $$ B = max(e^{b_{1}},e^{b_{2}},e^{b_{3}},e^{b_{4}})$$

则   

$$LLR\left ( b_{0}  \right ) \approx ln\left ( A \right ) -ln\left ( B\right )   \tag{5.5.2}$$

### 判决

如果 $LLR(b_{0}) > 0$，则 $b_{0} = 0$；
如果 $LLR(b_{0}) < 0$，则 $b_{0} = 1$.

## 推导 8-PSK 下$b_{1}$对数似然比 $LLR(b_{1})$

类似推导 8-PSK 下$b_{0}$对数似然比 $LLR(b_{0})$的过程，可以推导出 8-PSK 下$b_{1}$对数似然比 $LLR(b_{1})$.



I)  从公式$(1.3)$，当 $b_{1}=0$时，根据 8-PSK 调制表格，$I$和$Q$有四种情况：

​						 $I=c,Q=s$

​						 $I=s,Q=c$

​						 $I=s,Q=-c$

​						 $I=c,Q=-s$

可以认为$b_{1}=0$是与上面四种情况都发生是同一事件，因此，是四种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{1}=0)=p(y_{I},y_{Q}/I=c,Q=s)+p(y_{I},y_{Q}/I=s,Q=c)\\ +p(y_{I},y_{Q}/I=s,Q=-c)+p(y_{I},y_{Q}/I=c,Q=-s) \tag{6.1.1}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(6.1.1)$可以推导为：
$$p(y_{I},y_{Q}/b_{0}=0)=p(y_{I}/I=c)p(y_{Q}/Q=s)+p(y_{I}/I=s)p(y_{Q}/Q=c)\\ +p(y_{I}/I=s)p(y_{Q}/Q=-c)+p(y_{I}/I=c)p(y_{Q}/Q=-s) \tag{6.1.2}$$

II) 从公式$(1.3)$，当 $b_{1}=1$时，根据 8-PSK 调制表格，$I$和$Q$有四种情况：

​						 $I=-s,Q=c$

​						 $I=-c,Q=s$

​						 $I=-c,Q=-s$

​						 $I=-s,Q=-c$

可以认为$b_{1}=1$是与上面四种情况都发生是同一事件，因此，是四种情况下的概率的和，因此：
$$p(y_{I},y_{Q}/b_{0}=1)=p(y_{I},y_{Q}/I=-s,Q=c)+p(y_{I},y_{Q}/I=-c,Q=s)\\ +p(y_{I},y_{Q}/I=-c,Q=-s)+p(y_{I},y_{Q}/I=-s,Q=-c) \tag{6.1.3}$$

因为 I 和 Q 两路是两个白噪声信道，可以认为是相互独立的，因此，式$(6.1.3)$可以推导为：
$$p(y_{I},y_{Q}/b_{0}=1)=p(y_{I}/I=-s)p(y_{Q}/Q=c)+p(y_{I}/I=-c)p(y_{Q}/Q=s)\\ +p(y_{I}/I=-c)p(y_{Q}/Q=-s)+p(y_{I}/I=-s)p(y_{Q}/Q=-c) \tag{6.1.4}$$



### 计算$p(y_{I},y_{Q}/b_{1}=0)$

把式$(5.2.1)$至$(5.2.8)$代入$(6.1.2)$并整理：
$$ p(y_{I},y_{Q}/b_{0}=0)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-c})^2+(y_{Q}{\color{Red}-s})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-s})^2+(y_{Q}{\color{Red}-c})^2}{2\delta^2 }} + \\   \frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-s})^2+(y_{Q}{\color{Red}+c})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}-c})^2+(y_{Q}{\color{Red}+s})^2}{2\delta^2 }}\tag{6.2.1} $$

### 计算$p(y_{I},y_{Q}/b_{1}=1)$

类似与计算$p(y_{I},y_{Q}/b_{0}=0)$的思路，把式$(5.2.1)$至$(5.2.8)$代入$(6.1.4)$并整理：
$$ p(y_{I},y_{Q}/b_{1}=1)=\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red} +s} )^2+(y_{Q}{\color{Red}-c})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+c})^2+(y_{Q}{\color{Red}-s})^2}{2\delta^2 }} + \\   \frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+c})^2+(y_{Q}{\color{Red}+s})^2}{2\delta^2 }}+\frac{1}{2\pi\delta^2}e^{-\frac{(y_{I}{\color{Red}+s})^2+(y_{Q}{\color{Red}+c})^2}{2\delta^2 }}\tag{6.3.1} $$

### 

### 计算 $LR(b_{1})$

把式$(6.2.1)$和$(6.3.1)$代入$(1.3)$：
$$LR( b_{1} ) =  \frac{p(y_{I},y_{Q}/b_{1}=0)}{p(y_{I},y_{Q}/b_{1}=1)}  =   \frac{ e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}}}     {e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}} \tag{6.4.1 }$$

其中:

​             $$ a_{1} = -\frac{(y_{I}-c)^2+(y_{Q}-s)^2}{2\delta^2 } $$

​             $$ a_{2} = -\frac{(y_{I}-s)^2+(y_{Q}-c)^2}{2\delta^2 } $$

​             $$ a_{3} = -\frac{(y_{I}-s)^2+(y_{Q}+c)^2}{2\delta^2 } $$

​             $$ a_{4} = -\frac{(y_{I}-c)^2+(y_{Q}+s)^2}{2\delta^2 } $$

​             $$ b_{1} = -\frac{(y_{I}+s)^2+(y_{Q}-c)^2}{2\delta^2 } $$

​             $$ b_{2} = -\frac{(y_{I}+c)^2+(y_{Q}-s)^2}{2\delta^2 } $$

​             $$ b_{3} = -\frac{(y_{I}+c)^2+(y_{Q}+s)^2}{2\delta^2 } $$

​             $$ b_{4} = -\frac{(y_{I}+s)^2+(y_{Q}+c)^2}{2\delta^2 } $$



### 计算 $LLR(b_{1})$

对式$(6.4.1)$再取自然对数，生成对数似然比:

$$LLR( b_{1} ) =  ln \frac{p(y_{I},y_{Q}/b_{1}=0)}{p(y_{I},y_{Q}/b_{1}=1) }  =   ln\frac{ e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}}}     {e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}}\\=ln( e^{a_{1}}+e^{a_{2}}+e^{a_{3}}+e^{a_{4}})-     ln(e^{b_{1}}+e^{b_{2}}+e^{b_{3}}+e^{b_{4}}) \tag{6.5.1 }$$

式$(5.5.1)$已经不是很容易计算的公式了. 如果为了降低运算量，则需要简化计算。下面是一个近似计算方法.

因为$e^{b_{1}}$, $e^{b_{2}}$,$e^{b_{3}}$和$e^{b_{4}}$都是正数，因此取这四个数中最大的保留，其余的都舍弃:

​       $$ A = max(e^{a_{1}},e^{a_{2}},e^{a_{3}},e^{a_{4}})$$

​      $$ B = max(e^{b_{1}},e^{b_{2}},e^{b_{3}},e^{b_{4}})$$

则   

$$LLR\left ( b_{0}  \right ) \approx ln\left ( A \right ) -ln\left ( B\right )   \tag{6.5.2}$$

### 判决

如果 $LLR(b_{1}) > 0$，则 $b_{1} = 0$；
如果 $LLR(b_{1}) < 0$，则 $b_{1} = 1$.

## 推导 8-PSK 下$b_{2}$对数似然比 $LLR(b_{2})$

类似推导 8-PSK 下$b_{0}$对数似然比 $LLR(b_{0})$的过程，可以推导出 8-PSK 下 $b_{2}$ 对数似然比 $LLR(b_{2})$.

这个留给读者自己按照前面的过程推导吧.



# 待补充 QPSK和8-PSK的星座图

# 待补充 matlab 代码和 python 代码
